{% extends "base.html" %}
{% block content %}

<h3 class="section-title">Food Image Analysis</h3>

<div class="card-metric col-md-6">

<form id="analyzeForm" method="POST" enctype="multipart/form-data">


<label class="mb-2">Upload Food Image</label>
<input class="form-control mb-3" type="file" name="food_image"
       accept="image/*" onchange="previewImage(event)" required>

<!-- Preview -->
<img id="preview" class="img-fluid rounded mb-3"
     style="display:none; max-height:300px;">

<button id="analyzeBtn" class="btn btn-primary-soft">
    Run AI Detection
</button>

<!-- Spinner -->
<div id="loading" class="mt-3" style="display:none;">
    <div class="spinner-border text-success"></div>
    <div>Analyzing image with AI model...</div>
</div>

</form>

</div>

<script>
function previewImage(event) {
    const img = document.getElementById('preview');
    img.src = URL.createObjectURL(event.target.files[0]);
    img.style.display = "block";
}

function showLoading() {
    document.getElementById("loading").style.display = "block";
    document.getElementById("analyzeBtn").disabled = true;
}
<!-- Loading Overlay -->
<div id="loadingOverlay"
     style="display:none;
            position:fixed;
            top:0; left:0;
            width:100%; height:100%;
            background:rgba(0,0,0,0.6);
            z-index:9999;
            color:white;
            text-align:center;
            padding-top:20%;">

    <h3>ðŸ¤– Model warmingâ€¦ please wait</h3>
    <p>AI is loading and analyzing your food image</p>

</div>

</script>
<script>
document.getElementById("analyzeForm")
  .addEventListener("submit", function () {
      document.getElementById("loadingOverlay").style.display = "block";
});
</script>

{% endblock %}
